<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Flask Project</title>
    <!-- Link to the CSS file generated by Tailwind -->
    <link href="{{ url_for('static', filename='css/styles-min.css') }}" rel="stylesheet" />
    <!-- Include Flowbite JS (required for interactive components) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.js"></script>
  </head>

  <body class="bg-gray-50 dark:bg-gray-900">
    <!-- Navigation bar with Flowbite -->
    <nav class="bg-white shadow-md dark:bg-gray-800">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-16">
          <div class="flex items-center">
            <a href="{{ url_for('main.index') }}" class="text-xl font-bold text-gray-800 hover:text-blue-600 transition duration-300 dark:text-white dark:hover:text-blue-400">
              Home
            </a>
          </div>
          <div class="flex items-center space-x-4">
            {% if current_user.is_authenticated %}
            <span class="text-gray-800 dark:text-white">{{ current_user.username }}</span>
            <a href="{{ url_for('auth.logout') }}" class="text-gray-800 hover:text-blue-600 transition duration-300 dark:text-white dark:hover:text-blue-400">
              Logout
            </a>
            {% else %}
            <a href="{{ url_for('auth.register') }}" class="text-gray-800 hover:text-blue-600 transition duration-300 dark:text-white dark:hover:text-blue-400">
              Register
            </a>
            <a href="{{ url_for('auth.login') }}" class="text-gray-800 hover:text-blue-600 transition duration-300 dark:text-white dark:hover:text-blue-400">
              Login
            </a>
            {% endif %}
            <!-- Toggle button for dark mode -->
            <button id="theme-toggle" class="p-2 bg-gray-200 dark:bg-gray-700 rounded-lg">
              <span id="theme-icon">ðŸŒ™</span>
              <!-- Icon for dark mode -->
            </button>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main content -->
    <main class="dark:bg-gray-900">
      <!-- Flash messages handling -->
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %}
      <div id="flash-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full">
        <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white dark:bg-gray-800">
          <div class="mt-3 text-center">
            <div id="flash-icon" class="mx-auto flex items-center justify-center h-12 w-12 rounded-full">
              <!-- Dynamic icon -->
              <svg id="flash-icon-svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
            </div>
            <h3 id="flash-title" class="text-lg leading-6 font-medium text-gray-900 dark:text-white"></h3>
            <div class="mt-2 px-7 py-3">
              <p id="flash-message" class="text-sm text-gray-500 dark:text-gray-400" ></p>
            </div>
            <div class="items-center px-4 py-3">
              <button id="flash-close" class="px-4 py-2 bg-blue-500 text-white text-base font-medium rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-300">
                OK
              </button>
            </div>
          </div>
        </div>
      </div>
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          const messages = JSON.parse("{{ messages | tojson | safe }}");
          const modal = document.getElementById("flash-modal");
          const icon = document.getElementById("flash-icon");
          const iconSvg = document.getElementById("flash-icon-svg");
          const title = document.getElementById("flash-title");
          const message = document.getElementById("flash-message");
          const closeButton = document.getElementById("flash-close");

          if (messages && messages.length > 0) {
            const msg = messages[0]; // Take the first message for example
            title.textContent = msg[1];
            message.textContent = msg[1];

            // Change the icon and color based on the category
            if (msg[0] === "error") {
              icon.classList.add("bg-red-100");
              iconSvg.classList.add("text-red-600");
              iconSvg.innerHTML =
                '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />';
            } else if (msg[0] === "warning") {
              icon.classList.add("bg-yellow-100");
              iconSvg.classList.add("text-yellow-600");
              iconSvg.innerHTML =
                '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />';
            } else {
              icon.classList.add("bg-green-100");
              iconSvg.classList.add("text-green-600");
              iconSvg.innerHTML =
                '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />';
            }

            modal.classList.remove("hidden");

            closeButton.addEventListener("click", function () {
              modal.classList.add("hidden");
            });
          }
        });
      </script>
      {% endif %} {% endwith %} 
      {% block content %}{% endblock %}
    </main>

    <!-- Include your script.js -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>

    <!-- Script for dark mode handling -->
    <script src="{{ url_for('static', filename='js/theme.js') }}"></script>
  </body>
</html>